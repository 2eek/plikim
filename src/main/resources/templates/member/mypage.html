<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<style>
    /* 추가된 스타일 */
    #preview {

        border-radius: 50%;
        overflow: hidden;
    }

    #sform {
        display: flex;
        flex-direction: column;
        align-items: center;
    }

    form {
        width: 700px
    }

    /*#table-container {*/
    /*    width: 150%;*/
    /*    margin-top: 20px;*/
    /*}*/

    table {
        border-collapse: collapse;
        width: 100%;
    }

    th, td {
        border: 1px solid #dddddd;
        text-align: left;
        padding: 8px;
    }

    th {
        background-color: #f2f2f2;
    }

    textarea {
        width: 100%;
        height: 100px;
    }

    #form-submit {
        align-self: flex-end;
        margin-top: 20px;
    }
</style>

<head th:replace="fragments/common :: head('회원 수정')">
</head>

<body>
<nav class="navbar navbar-expand-md navbar-dark bg-dark fixed-top" th:replace="fragments/common :: menu('home')">
</nav>

<div id="sform">
    <form action="/user/update" enctype="multipart/form-data" method="post">
        <input type="hidden" name="userId" th:value="${userId}">

        <!-- 파일 업로드 -->

        <br>
        <div id="preview">
            <img th:src="@{${#strings.isEmpty(commonUser.storedFileName) ? '/uploads/basicProfile.jpg' : '/uploads/' + commonUser.storedFileName}}"
                 alt="Profile Image" style="width: 200px; height: 200px; object-fit: cover;">
        </div>
        <label for="profileFile">프로필 이미지:</label>
        <input type="file" name="profileFile" id="profileFile" onchange="previewImage(this)">
        <br>

        <!-- 회원 정보 테이블 -->
        <div id="table-container">
            <table>
                <tr>
                    <th>항목</th>
                    <th>값</th>
                </tr>
                <tr>
                    <td>아이디</td>
                    <td><span th:text="${userId}"></span></td>
                </tr>
                <tr>
                    <td>이메일</td>
                    <td><span th:text="${userEmail}"></span></td>
                </tr>
                <tr>
                    <td>휴대폰 번호</td>
                    <td><span th:text="${userPhoneNumber}"></span></td>
                </tr>
                <tr>
                    <td>자기소개</td>
                    <td><textarea name="selfIntroduction" th:text="${selfIntroduction}"></textarea></td>
                </tr>
            </table>
        </div>

        <input type="submit" value="저장" id="form-submit">
    </form>
</div>

<script>
    function previewImage(input) {
        var preview = document.getElementById('preview');
        if (input.files && input.files[0]) {
            var reader = new FileReader();

            reader.onload = function (e) {
                preview.innerHTML = '<img src="' + e.target.result + '" alt="Profile Image" style="width: 200px; height: 200px; object-fit: cover;">';
            };

            reader.readAsDataURL(input.files[0]);
        }
    }
</script>
</body>

</html>
